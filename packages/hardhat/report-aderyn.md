# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk](#l-1-centralization-risk)
  - [L-2: Unspecific Solidity Pragma](#l-2-unspecific-solidity-pragma)
  - [L-3: Address State Variable Set Without Checks](#l-3-address-state-variable-set-without-checks)
  - [L-4: Public Function Not Used Internally](#l-4-public-function-not-used-internally)
  - [L-5: Literal Instead of Constant](#l-5-literal-instead-of-constant)
  - [L-6: PUSH0 Opcode](#l-6-push0-opcode)
  - [L-7: Modifier Invoked Only Once](#l-7-modifier-invoked-only-once)
  - [L-8: Large Numeric Literal](#l-8-large-numeric-literal)
  - [L-9: Loop Contains `require`/`revert`](#l-9-loop-contains-requirerevert)
  - [L-10: Uninitialized Local Variable](#l-10-uninitialized-local-variable)
  - [L-11: Costly operations inside loop](#l-11-costly-operations-inside-loop)
  - [L-12: Missing Inheritance](#l-12-missing-inheritance)
  - [L-13: Unused Import](#l-13-unused-import)
  - [L-14: State Change Without Event](#l-14-state-change-without-event)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 24 |
| Total nSLOC | 1509 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| contracts/accounts/SimpleAccount.sol | 2 |
| contracts/accounts/SimpleAccountFactory.sol | 2 |
| contracts/core/GasXConfig.sol | 47 |
| contracts/core/GasXERC20FeePaymaster.sol | 180 |
| contracts/core/GasXSubscriptions.sol | 489 |
| contracts/core/GasXWhitelistPaymaster.sol | 131 |
| contracts/factories/AggregatorFactory.sol | 115 |
| contracts/factories/DIAAdapterFactory.sol | 29 |
| contracts/imports/Imports.sol | 2 |
| contracts/interfaces/IDIAOracleV2.sol | 4 |
| contracts/interfaces/IOracleAggregator.sol | 4 |
| contracts/interfaces/IPriceOracle.sol | 4 |
| contracts/mocks/MockDIAOracle.sol | 14 |
| contracts/mocks/MockERC20.sol | 7 |
| contracts/mocks/MockERC20Decimals.sol | 17 |
| contracts/mocks/MockEulerOracle.sol | 16 |
| contracts/mocks/MockOracle.sol | 20 |
| contracts/mocks/MockTarget.sol | 7 |
| contracts/oracles/DIAOracleAdapter.sol | 42 |
| contracts/oracles/EulerOracleAdapter.sol | 33 |
| contracts/oracles/MultiOracleAggregator.sol | 266 |
| contracts/testutils/MultiOracleAggregatorV2.sol | 14 |
| contracts/testutils/TestableGasX.sol | 19 |
| contracts/testutils/TestableGasXERC20.sol | 45 |
| **Total** | **1509** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 0 |
| Low | 14 |


# Low Issues

## L-1: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>49 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 84](contracts/core/GasXConfig.sol#L84)

	```solidity
	    function setOracleSigner(address newSigner) external onlyOwner {
	```

- Found in contracts/core/GasXConfig.sol [Line: 98](contracts/core/GasXConfig.sol#L98)

	```solidity
	    function setMaxUsd(bytes4 selector, uint256 maxUsd) external onlyOwner {
	```

- Found in contracts/core/GasXConfig.sol [Line: 111](contracts/core/GasXConfig.sol#L111)

	```solidity
	    function bulkSetMaxUsd(bytes4[] calldata selectors, uint256[] calldata maxUsds) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 184](contracts/core/GasXERC20FeePaymaster.sol#L184)

	```solidity
	    function setOracleSigner(address _newSigner) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 195](contracts/core/GasXERC20FeePaymaster.sol#L195)

	```solidity
	    function setMinFee(uint256 _newMinFee) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 205](contracts/core/GasXERC20FeePaymaster.sol#L205)

	```solidity
	    function setFeeMarkup(uint256 _newMarkupBps) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 217](contracts/core/GasXERC20FeePaymaster.sol#L217)

	```solidity
	    function withdrawFees(address _to, uint256 _amount) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 234](contracts/core/GasXERC20FeePaymaster.sol#L234)

	```solidity
	    function withdrawToken(address _token, address _to, uint256 _amount) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 244](contracts/core/GasXERC20FeePaymaster.sol#L244)

	```solidity
	    function pause() external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 251](contracts/core/GasXERC20FeePaymaster.sol#L251)

	```solidity
	    function unpause() external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 262](contracts/core/GasXERC20FeePaymaster.sol#L262)

	```solidity
	    function emergencyWithdrawEth(address payable _to, uint256 _amount) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 247](contracts/core/GasXSubscriptions.sol#L247)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 262](contracts/core/GasXSubscriptions.sol#L262)

	```solidity
	    function scheduleUpgrade(address newImplementation) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 274](contracts/core/GasXSubscriptions.sol#L274)

	```solidity
	    function cancelUpgrade() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 511](contracts/core/GasXSubscriptions.sol#L511)

	```solidity
	    function useCredits(address user, uint256 amount, string calldata reason) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 525](contracts/core/GasXSubscriptions.sol#L525)

	```solidity
	    function refundCredits(address user, uint256 amount) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 590](contracts/core/GasXSubscriptions.sol#L590)

	```solidity
	    ) external onlyOwner returns (uint256 planId) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 614](contracts/core/GasXSubscriptions.sol#L614)

	```solidity
	    ) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 634](contracts/core/GasXSubscriptions.sol#L634)

	```solidity
	    ) external onlyOwner returns (uint256 packId) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 650](contracts/core/GasXSubscriptions.sol#L650)

	```solidity
	    function addSupportedToken(address token, uint8 decimals) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 660](contracts/core/GasXSubscriptions.sol#L660)

	```solidity
	    function removeSupportedToken(address token) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 668](contracts/core/GasXSubscriptions.sol#L668)

	```solidity
	    function setTreasury(address newTreasury) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 677](contracts/core/GasXSubscriptions.sol#L677)

	```solidity
	    function setFeeCollector(address newFeeCollector) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 687](contracts/core/GasXSubscriptions.sol#L687)

	```solidity
	    function transferOwnership(address newOwner) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 708](contracts/core/GasXSubscriptions.sol#L708)

	```solidity
	    function cancelOwnershipTransfer() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 721](contracts/core/GasXSubscriptions.sol#L721)

	```solidity
	    function pause() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 728](contracts/core/GasXSubscriptions.sol#L728)

	```solidity
	    function unpause() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 738](contracts/core/GasXSubscriptions.sol#L738)

	```solidity
	    function emergencyWithdrawToken(address token, address to, uint256 amount) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 749](contracts/core/GasXSubscriptions.sol#L749)

	```solidity
	    function emergencyWithdrawEth(address to, uint256 amount) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 240](contracts/core/GasXWhitelistPaymaster.sol#L240)

	```solidity
	    function setLimit(uint256 gas, uint256 usd) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 251](contracts/core/GasXWhitelistPaymaster.sol#L251)

	```solidity
	    function setSelector(bytes4 sel, bool allowed) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 261](contracts/core/GasXWhitelistPaymaster.sol#L261)

	```solidity
	    function setDevMode(bool enabled) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 270](contracts/core/GasXWhitelistPaymaster.sol#L270)

	```solidity
	    function pause() external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 278](contracts/core/GasXWhitelistPaymaster.sol#L278)

	```solidity
	    function unpause() external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 290](contracts/core/GasXWhitelistPaymaster.sol#L290)

	```solidity
	    function emergencyWithdrawEth(address payable to, uint256 amount) external onlyOwner {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 133](contracts/factories/AggregatorFactory.sol#L133)

	```solidity
	    function transferOwnership(address newOwner) external onlyOwner {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 162](contracts/factories/AggregatorFactory.sol#L162)

	```solidity
	    ) external onlyOwner returns (address aggregator) {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 210](contracts/factories/AggregatorFactory.sol#L210)

	```solidity
	    function removeAggregator(address base, address quote) external onlyOwner {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 225](contracts/factories/AggregatorFactory.sol#L225)

	```solidity
	    function transferAggregatorOwnership(address base, address quote, address newOwner) external onlyOwner {
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 86](contracts/factories/DIAAdapterFactory.sol#L86)

	```solidity
	    function deployAdapter(address base, address quote, string calldata key) external onlyOwner returns (address) {
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 77](contracts/oracles/DIAOracleAdapter.sol#L77)

	```solidity
	    function setPairKey(address base, address quote, string memory key) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 124](contracts/oracles/MultiOracleAggregator.sol#L124)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal view override onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 148](contracts/oracles/MultiOracleAggregator.sol#L148)

	```solidity
	    function addOracle(address base, address quote, address oracle) external onlyOwner onlyValidPair(base, quote) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 165](contracts/oracles/MultiOracleAggregator.sol#L165)

	```solidity
	    function removeOracle(address base, address quote, uint256 index) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 181](contracts/oracles/MultiOracleAggregator.sol#L181)

	```solidity
	    function updateOracle(address base, address quote, uint256 index, address newOracle) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 201](contracts/oracles/MultiOracleAggregator.sol#L201)

	```solidity
	    function toggleOracle(address base, address quote, uint256 index, bool enabled) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 213](contracts/oracles/MultiOracleAggregator.sol#L213)

	```solidity
	    function setMaxDeviationBps(uint256 bps) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 225](contracts/oracles/MultiOracleAggregator.sol#L225)

	```solidity
	    function setTrustedForwarder(address forwarder) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 478](contracts/oracles/MultiOracleAggregator.sol#L478)

	```solidity
	    function emergencyWithdrawEth(address payable to) external onlyOwner {
	```

</details>



## L-2: Unspecific Solidity Pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>24 Found Instances</summary>


- Found in contracts/accounts/SimpleAccount.sol [Line: 2](contracts/accounts/SimpleAccount.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/accounts/SimpleAccountFactory.sol [Line: 2](contracts/accounts/SimpleAccountFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXConfig.sol [Line: 2](contracts/core/GasXConfig.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 2](contracts/core/GasXERC20FeePaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 2](contracts/core/GasXSubscriptions.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 2](contracts/core/GasXWhitelistPaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 2](contracts/factories/AggregatorFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 2](contracts/factories/DIAAdapterFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/imports/Imports.sol [Line: 2](contracts/imports/Imports.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IDIAOracleV2.sol [Line: 2](contracts/interfaces/IDIAOracleV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IOracleAggregator.sol [Line: 2](contracts/interfaces/IOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IPriceOracle.sol [Line: 2](contracts/interfaces/IPriceOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockDIAOracle.sol [Line: 2](contracts/mocks/MockDIAOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20.sol [Line: 2](contracts/mocks/MockERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20Decimals.sol [Line: 2](contracts/mocks/MockERC20Decimals.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 2](contracts/mocks/MockEulerOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockOracle.sol [Line: 2](contracts/mocks/MockOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockTarget.sol [Line: 2](contracts/mocks/MockTarget.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 2](contracts/oracles/DIAOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/EulerOracleAdapter.sol [Line: 2](contracts/oracles/EulerOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 2](contracts/oracles/MultiOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 2](contracts/testutils/MultiOracleAggregatorV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasX.sol [Line: 2](contracts/testutils/TestableGasX.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 2](contracts/testutils/TestableGasXERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

</details>



## L-3: Address State Variable Set Without Checks

Check for `address(0)` when assigning values to address state variables.

<details><summary>1 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 227](contracts/oracles/MultiOracleAggregator.sol#L227)

	```solidity
	        _trustedForwarder = forwarder;
	```

</details>



## L-4: Public Function Not Used Internally

If a function is marked public but is not used internally, consider marking it as `external`.

<details><summary>4 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 275](contracts/oracles/MultiOracleAggregator.sol#L275)

	```solidity
	    function computeQuoteAverage(uint256 amount, address base, address quote) public view returns (uint256) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 345](contracts/oracles/MultiOracleAggregator.sol#L345)

	```solidity
	    function computeQuoteMedian(uint256 amount, address base, address quote) public view returns (uint256) {
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 26](contracts/testutils/MultiOracleAggregatorV2.sol#L26)

	```solidity
	    function initializeV2() public reinitializer(2) {
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 36](contracts/testutils/MultiOracleAggregatorV2.sol#L36)

	```solidity
	    function version() public pure returns (string memory) {
	```

</details>



## L-5: Literal Instead of Constant

Define and use `constant` variables instead of using literals. If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>42 Found Instances</summary>


- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 84](contracts/core/GasXERC20FeePaymaster.sol#L84)

	```solidity
	        require(_feeMarkupBps <= 1000, "GasX: Markup too high"); // Max 10%
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 132](contracts/core/GasXERC20FeePaymaster.sol#L132)

	```solidity
	        onChainPrice = priceOracle.computeQuoteAverage(1e18, priceQuoteBaseToken, feeToken);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 135](contracts/core/GasXERC20FeePaymaster.sol#L135)

	```solidity
	        require((diff * 10_000) / onChainPrice <= PRICE_DEVIATION_BPS, "GasX: Price deviation too high");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 143](contracts/core/GasXERC20FeePaymaster.sol#L143)

	```solidity
	        fee = (gasCost * price * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 162](contracts/core/GasXERC20FeePaymaster.sol#L162)

	```solidity
	        uint256 actualFee = (actualGasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 206](contracts/core/GasXERC20FeePaymaster.sol#L206)

	```solidity
	        require(_newMarkupBps <= 1000, "GasX: Markup too high");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 305](contracts/core/GasXERC20FeePaymaster.sol#L305)

	```solidity
	        uint256 onChainPrice = priceOracle.computeQuoteAverage(1e18, priceQuoteBaseToken, feeToken);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 308](contracts/core/GasXERC20FeePaymaster.sol#L308)

	```solidity
	        estimatedFee = (_gasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 235](contracts/core/GasXSubscriptions.sol#L235)

	```solidity
	        tokenDecimals[_usdc] = 6;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 236](contracts/core/GasXSubscriptions.sol#L236)

	```solidity
	        emit TokenAdded(_usdc, 6);
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 304](contracts/core/GasXSubscriptions.sol#L304)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 350](contracts/core/GasXSubscriptions.sol#L350)

	```solidity
	        uint256 fee = (plan.priceEth * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 426](contracts/core/GasXSubscriptions.sol#L426)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 774](contracts/core/GasXSubscriptions.sol#L774)

	```solidity
	        if (decimals == 6) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 776](contracts/core/GasXSubscriptions.sol#L776)

	```solidity
	        } else if (decimals > 6) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 777](contracts/core/GasXSubscriptions.sol#L777)

	```solidity
	            result = usdcAmount * (10 ** (decimals - 6));
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 779](contracts/core/GasXSubscriptions.sol#L779)

	```solidity
	            result = usdcAmount / (10 ** (6 - decimals));
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 795](contracts/core/GasXSubscriptions.sol#L795)

	```solidity
	            durationDays: 30,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 796](contracts/core/GasXSubscriptions.sol#L796)

	```solidity
	            platformFeeBps: 500, // 5%
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 805](contracts/core/GasXSubscriptions.sol#L805)

	```solidity
	            durationDays: 30,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 806](contracts/core/GasXSubscriptions.sol#L806)

	```solidity
	            platformFeeBps: 250, // 2.5%
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 815](contracts/core/GasXSubscriptions.sol#L815)

	```solidity
	            durationDays: 30,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 816](contracts/core/GasXSubscriptions.sol#L816)

	```solidity
	            platformFeeBps: 100, // 1%
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 825](contracts/core/GasXSubscriptions.sol#L825)

	```solidity
	            durationDays: 365,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 826](contracts/core/GasXSubscriptions.sol#L826)

	```solidity
	            platformFeeBps: 250,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 835](contracts/core/GasXSubscriptions.sol#L835)

	```solidity
	            durationDays: 365,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 836](contracts/core/GasXSubscriptions.sol#L836)

	```solidity
	            platformFeeBps: 100,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 848](contracts/core/GasXSubscriptions.sol#L848)

	```solidity
	            credits: 100,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 858](contracts/core/GasXSubscriptions.sol#L858)

	```solidity
	            credits: 500,
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 117](contracts/oracles/MultiOracleAggregator.sol#L117)

	```solidity
	        if (deviationBps > 10_000) revert DeviationTooHigh(deviationBps);
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 214](contracts/oracles/MultiOracleAggregator.sol#L214)

	```solidity
	        if (bps > 10_000) revert DeviationTooHigh(bps);
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 297](contracts/oracles/MultiOracleAggregator.sol#L297)

	```solidity
	            uint256 deviationBps = (diff * 10_000) / avg;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 366](contracts/oracles/MultiOracleAggregator.sol#L366)

	```solidity
	            uint256 deviationBps = (diff * 10_000) / med;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 403](contracts/oracles/MultiOracleAggregator.sol#L403)

	```solidity
	            uint256 deviationBps = (diff * 10_000) / params.refPrice;
	```

</details>



## L-6: PUSH0 Opcode

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>24 Found Instances</summary>


- Found in contracts/accounts/SimpleAccount.sol [Line: 2](contracts/accounts/SimpleAccount.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/accounts/SimpleAccountFactory.sol [Line: 2](contracts/accounts/SimpleAccountFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXConfig.sol [Line: 2](contracts/core/GasXConfig.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 2](contracts/core/GasXERC20FeePaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 2](contracts/core/GasXSubscriptions.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 2](contracts/core/GasXWhitelistPaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 2](contracts/factories/AggregatorFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 2](contracts/factories/DIAAdapterFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/imports/Imports.sol [Line: 2](contracts/imports/Imports.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IDIAOracleV2.sol [Line: 2](contracts/interfaces/IDIAOracleV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IOracleAggregator.sol [Line: 2](contracts/interfaces/IOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IPriceOracle.sol [Line: 2](contracts/interfaces/IPriceOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockDIAOracle.sol [Line: 2](contracts/mocks/MockDIAOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20.sol [Line: 2](contracts/mocks/MockERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20Decimals.sol [Line: 2](contracts/mocks/MockERC20Decimals.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 2](contracts/mocks/MockEulerOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockOracle.sol [Line: 2](contracts/mocks/MockOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockTarget.sol [Line: 2](contracts/mocks/MockTarget.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 2](contracts/oracles/DIAOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/EulerOracleAdapter.sol [Line: 2](contracts/oracles/EulerOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 2](contracts/oracles/MultiOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 2](contracts/testutils/MultiOracleAggregatorV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasX.sol [Line: 2](contracts/testutils/TestableGasX.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 2](contracts/testutils/TestableGasXERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

</details>



## L-7: Modifier Invoked Only Once

Consider removing the modifier or inlining the logic into the calling function.

<details><summary>3 Found Instances</summary>


- Found in contracts/factories/DIAAdapterFactory.sol [Line: 52](contracts/factories/DIAAdapterFactory.sol#L52)

	```solidity
	    modifier onlyOwner() {
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 49](contracts/oracles/DIAOracleAdapter.sol#L49)

	```solidity
	    modifier onlyOwner() {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 131](contracts/oracles/MultiOracleAggregator.sol#L131)

	```solidity
	    modifier onlyValidPair(address base, address quote) {
	```

</details>



## L-8: Large Numeric Literal

Large literal values multiples of 10000 can be replaced with scientific notation.Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>31 Found Instances</summary>


- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 135](contracts/core/GasXERC20FeePaymaster.sol#L135)

	```solidity
	        require((diff * 10_000) / onChainPrice <= PRICE_DEVIATION_BPS, "GasX: Price deviation too high");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 143](contracts/core/GasXERC20FeePaymaster.sol#L143)

	```solidity
	        fee = (gasCost * price * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 162](contracts/core/GasXERC20FeePaymaster.sol#L162)

	```solidity
	        uint256 actualFee = (actualGasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 308](contracts/core/GasXERC20FeePaymaster.sol#L308)

	```solidity
	        estimatedFee = (_gasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 304](contracts/core/GasXSubscriptions.sol#L304)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 350](contracts/core/GasXSubscriptions.sol#L350)

	```solidity
	        uint256 fee = (plan.priceEth * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 426](contracts/core/GasXSubscriptions.sol#L426)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 803](contracts/core/GasXSubscriptions.sol#L803)

	```solidity
	            priceUsdc: 99_000000, // 99 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 804](contracts/core/GasXSubscriptions.sol#L804)

	```solidity
	            priceEth: 40000000000000000, // 0.04 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 813](contracts/core/GasXSubscriptions.sol#L813)

	```solidity
	            priceUsdc: 499_000000, // 499 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 814](contracts/core/GasXSubscriptions.sol#L814)

	```solidity
	            priceEth: 200000000000000000, // 0.2 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 823](contracts/core/GasXSubscriptions.sol#L823)

	```solidity
	            priceUsdc: 999_000000, // 999 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 824](contracts/core/GasXSubscriptions.sol#L824)

	```solidity
	            priceEth: 400000000000000000, // 0.4 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 833](contracts/core/GasXSubscriptions.sol#L833)

	```solidity
	            priceUsdc: 4990_000000, // 4990 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 834](contracts/core/GasXSubscriptions.sol#L834)

	```solidity
	            priceEth: 2000000000000000000, // 2 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 850](contracts/core/GasXSubscriptions.sol#L850)

	```solidity
	            priceUsdc: 10_000000, // 10 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 851](contracts/core/GasXSubscriptions.sol#L851)

	```solidity
	            priceEth: 4000000000000000, // 0.004 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 860](contracts/core/GasXSubscriptions.sol#L860)

	```solidity
	            priceUsdc: 45_000000, // 45 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 861](contracts/core/GasXSubscriptions.sol#L861)

	```solidity
	            priceEth: 18000000000000000, // 0.018 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 870](contracts/core/GasXSubscriptions.sol#L870)

	```solidity
	            priceUsdc: 80_000000, // 80 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 871](contracts/core/GasXSubscriptions.sol#L871)

	```solidity
	            priceEth: 32000000000000000, // 0.032 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 880](contracts/core/GasXSubscriptions.sol#L880)

	```solidity
	            priceUsdc: 350_000000, // 350 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 881](contracts/core/GasXSubscriptions.sol#L881)

	```solidity
	            priceEth: 140000000000000000, // 0.14 ETH
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 117](contracts/oracles/MultiOracleAggregator.sol#L117)

	```solidity
	        if (deviationBps > 10_000) revert DeviationTooHigh(deviationBps);
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 214](contracts/oracles/MultiOracleAggregator.sol#L214)

	```solidity
	        if (bps > 10_000) revert DeviationTooHigh(bps);
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 297](contracts/oracles/MultiOracleAggregator.sol#L297)

	```solidity
	            uint256 deviationBps = (diff * 10_000) / avg;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 366](contracts/oracles/MultiOracleAggregator.sol#L366)

	```solidity
	            uint256 deviationBps = (diff * 10_000) / med;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 403](contracts/oracles/MultiOracleAggregator.sol#L403)

	```solidity
	            uint256 deviationBps = (diff * 10_000) / params.refPrice;
	```

</details>



## L-9: Loop Contains `require`/`revert`

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>9 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 151](contracts/oracles/MultiOracleAggregator.sol#L151)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 185](contracts/oracles/MultiOracleAggregator.sol#L185)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 249](contracts/oracles/MultiOracleAggregator.sol#L249)

	```solidity
	        for (uint256 i = 0; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 282](contracts/oracles/MultiOracleAggregator.sol#L282)

	```solidity
	        for (uint256 i = 0; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 295](contracts/oracles/MultiOracleAggregator.sol#L295)

	```solidity
	        for (uint256 i = 0; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 318](contracts/oracles/MultiOracleAggregator.sol#L318)

	```solidity
	        for (uint256 i = 0; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 351](contracts/oracles/MultiOracleAggregator.sol#L351)

	```solidity
	        for (uint256 i = 0; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 364](contracts/oracles/MultiOracleAggregator.sol#L364)

	```solidity
	        for (uint256 i = 0; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 401](contracts/oracles/MultiOracleAggregator.sol#L401)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

</details>



## L-10: Uninitialized Local Variable

Initialize all the variables. If a variable is meant to be initialized to zero, explicitly set it to zero to improve code readability.

<details><summary>3 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 151](contracts/oracles/MultiOracleAggregator.sol#L151)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 185](contracts/oracles/MultiOracleAggregator.sol#L185)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 401](contracts/oracles/MultiOracleAggregator.sol#L401)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

</details>



## L-11: Costly operations inside loop

Invoking `SSTORE` operations in loops may waste gas. Use a local variable to hold the loop computation result.

<details><summary>1 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 113](contracts/core/GasXConfig.sol#L113)

	```solidity
	        for (uint256 i = 0; i < selectors.length; i++) {
	```

</details>



## L-12: Missing Inheritance

There is an interface / abstract contract that is potentially missing (not included in) the inheritance of this contract.

<details><summary>2 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 12](contracts/core/GasXConfig.sol#L12)

	Is this contract supposed to implement an interface? Consider extending one of the following: IGasXConfig
	```solidity
	contract GasXConfig {
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 7](contracts/mocks/MockEulerOracle.sol#L7)

	Is this contract supposed to implement an interface? Consider extending one of the following: IEulerOracle
	```solidity
	contract MockEulerOracle {
	```

</details>



## L-13: Unused Import

Redundant import statement. Consider removing it.

<details><summary>7 Found Instances</summary>


- Found in contracts/accounts/SimpleAccount.sol [Line: 3](contracts/accounts/SimpleAccount.sol#L3)

	```solidity
	import "@account-abstraction/contracts/accounts/SimpleAccount.sol";
	```

- Found in contracts/accounts/SimpleAccountFactory.sol [Line: 3](contracts/accounts/SimpleAccountFactory.sol#L3)

	```solidity
	import "@account-abstraction/contracts/accounts/SimpleAccountFactory.sol";
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 6](contracts/factories/AggregatorFactory.sol#L6)

	```solidity
	import { IPriceOracle } from "../interfaces/IPriceOracle.sol";
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 7](contracts/factories/AggregatorFactory.sol#L7)

	```solidity
	import { EulerOracleAdapter } from "../oracles/EulerOracleAdapter.sol";
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 5](contracts/factories/DIAAdapterFactory.sol#L5)

	```solidity
	import { IOracleAggregator } from "../interfaces/IOracleAggregator.sol";
	```

- Found in contracts/imports/Imports.sol [Line: 9](contracts/imports/Imports.sol#L9)

	```solidity
	import "@account-abstraction/contracts/core/EntryPoint.sol";
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 7](contracts/oracles/MultiOracleAggregator.sol#L7)

	```solidity
	import { ContextUpgradeable } from "@openzeppelin/contracts-upgradeable/utils/ContextUpgradeable.sol";
	```

</details>



## L-14: State Change Without Event

There are state variable changes in this function but no event is emitted. Consider emitting an event to enable offchain indexers to track the changes.

<details><summary>6 Found Instances</summary>


- Found in contracts/mocks/MockDIAOracle.sol [Line: 14](contracts/mocks/MockDIAOracle.sol#L14)

	```solidity
	    function setValue(string memory key, uint128 price, uint128 timestamp) external {
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 14](contracts/mocks/MockEulerOracle.sol#L14)

	```solidity
	    function setPrice(uint256 _price) external {
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 18](contracts/mocks/MockEulerOracle.sol#L18)

	```solidity
	    function setMockPrice(uint256 _price) external {
	```

- Found in contracts/mocks/MockOracle.sol [Line: 17](contracts/mocks/MockOracle.sol#L17)

	```solidity
	    function setQuote(uint256 newQuote) external {
	```

- Found in contracts/mocks/MockOracle.sol [Line: 21](contracts/mocks/MockOracle.sol#L21)

	```solidity
	    function setRevert(bool shouldRevert) external {
	```

- Found in contracts/mocks/MockTarget.sol [Line: 7](contracts/mocks/MockTarget.sol#L7)

	```solidity
	    function execute() external {
	```

</details>



