# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Contract Name Reused in Different Files](#h-1-contract-name-reused-in-different-files)
  - [H-2: ETH transferred without address checks](#h-2-eth-transferred-without-address-checks)
  - [H-3: Contract locks Ether without a withdraw function](#h-3-contract-locks-ether-without-a-withdraw-function)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk](#l-1-centralization-risk)
  - [L-2: Unspecific Solidity Pragma](#l-2-unspecific-solidity-pragma)
  - [L-3: Address State Variable Set Without Checks](#l-3-address-state-variable-set-without-checks)
  - [L-4: Public Function Not Used Internally](#l-4-public-function-not-used-internally)
  - [L-5: Literal Instead of Constant](#l-5-literal-instead-of-constant)
  - [L-6: PUSH0 Opcode](#l-6-push0-opcode)
  - [L-7: Modifier Invoked Only Once](#l-7-modifier-invoked-only-once)
  - [L-8: Empty Block](#l-8-empty-block)
  - [L-9: Large Numeric Literal](#l-9-large-numeric-literal)
  - [L-10: Loop Contains `require`/`revert`](#l-10-loop-contains-requirerevert)
  - [L-11: Uninitialized Local Variable](#l-11-uninitialized-local-variable)
  - [L-12: Costly operations inside loop](#l-12-costly-operations-inside-loop)
  - [L-13: Missing Inheritance](#l-13-missing-inheritance)
  - [L-14: Unused Import](#l-14-unused-import)
  - [L-15: State Change Without Event](#l-15-state-change-without-event)
  - [L-16: State Variable Could Be Immutable](#l-16-state-variable-could-be-immutable)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 23 |
| Total nSLOC | 1421 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| contracts/SimpleAccount.sol | 2 |
| contracts/SimpleAccountFactory.sol | 2 |
| contracts/core/GasXConfig.sol | 41 |
| contracts/core/GasXERC20FeePaymaster.sol | 169 |
| contracts/core/GasXSubscriptions.sol | 516 |
| contracts/core/GasXWhitelistPaymaster.sol | 121 |
| contracts/factories/AggregatorFactory.sol | 107 |
| contracts/factories/DIAAdapterFactory.sol | 23 |
| contracts/imports/Imports.sol | 2 |
| contracts/interfaces/IDIAOracleV2.sol | 4 |
| contracts/interfaces/IOracleAggregator.sol | 4 |
| contracts/interfaces/IPriceOracle.sol | 4 |
| contracts/mocks/MockERC20.sol | 7 |
| contracts/mocks/MockERC20Decimals.sol | 17 |
| contracts/mocks/MockEulerOracle.sol | 16 |
| contracts/mocks/MockOracle.sol | 20 |
| contracts/mocks/MockTarget.sol | 7 |
| contracts/oracles/DIAOracleAdapter.sol | 32 |
| contracts/oracles/EulerOracleAdapter.sol | 27 |
| contracts/oracles/MultiOracleAggregator.sol | 217 |
| contracts/testutils/MultiOracleAggregatorV2.sol | 14 |
| contracts/testutils/TestableGasX.sol | 19 |
| contracts/testutils/TestableGasXERC20.sol | 50 |
| **Total** | **1421** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 3 |
| Low | 16 |


# High Issues

## H-1: Contract Name Reused in Different Files

When compiling contracts with certain development frameworks (for example: Truffle), having contracts with the same name across different files can lead to one being overwritten.

<details><summary>2 Found Instances</summary>


- Found in contracts/mocks/MockEulerOracle.sol [Line: 4](contracts/mocks/MockEulerOracle.sol#L4)

	```solidity
	interface IEulerOracle {
	```

- Found in contracts/oracles/EulerOracleAdapter.sol [Line: 18](contracts/oracles/EulerOracleAdapter.sol#L18)

	```solidity
	interface IEulerOracle {
	```

</details>



## H-2: ETH transferred without address checks

Consider introducing checks for `msg.sender` to ensure the recipient of the money is as intended.

<details><summary>2 Found Instances</summary>


- Found in contracts/core/GasXSubscriptions.sol [Line: 352](contracts/core/GasXSubscriptions.sol#L352)

	```solidity
	    function subscribeWithEth(
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 492](contracts/core/GasXSubscriptions.sol#L492)

	```solidity
	    function purchaseCreditsWithEth(uint256 packId) external payable nonReentrant whenNotPaused {
	```

</details>



## H-3: Contract locks Ether without a withdraw function

It appears that the contract includes a payable function to accept Ether but lacks a corresponding function to withdraw it, which leads to the Ether being locked in the contract. To resolve this issue, please implement a public or external function that allows for the withdrawal of Ether from the contract.

<details><summary>6 Found Instances</summary>


- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 24](contracts/core/GasXERC20FeePaymaster.sol#L24)

	```solidity
	contract GasXERC20FeePaymaster is BasePaymaster, Pausable {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 40](contracts/core/GasXWhitelistPaymaster.sol#L40)

	```solidity
	contract GasXWhitelistPaymaster is BasePaymaster, Pausable {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 15](contracts/oracles/MultiOracleAggregator.sol#L15)

	```solidity
	contract MultiOracleAggregator is OwnableUpgradeable, UUPSUpgradeable {
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 12](contracts/testutils/MultiOracleAggregatorV2.sol#L12)

	```solidity
	contract MultiOracleAggregatorV2 is MultiOracleAggregator {
	```

- Found in contracts/testutils/TestableGasX.sol [Line: 7](contracts/testutils/TestableGasX.sol#L7)

	```solidity
	contract TestableGasX is GasXWhitelistPaymaster {
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 8](contracts/testutils/TestableGasXERC20.sol#L8)

	```solidity
	contract TestableGasXERC20 is GasXERC20FeePaymaster {
	```

</details>



# Low Issues

## L-1: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>45 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 73](contracts/core/GasXConfig.sol#L73)

	```solidity
	    function setOracleSigner(address newSigner) external onlyOwner {
	```

- Found in contracts/core/GasXConfig.sol [Line: 85](contracts/core/GasXConfig.sol#L85)

	```solidity
	    function setMaxUsd(bytes4 selector, uint256 maxUsd) external onlyOwner {
	```

- Found in contracts/core/GasXConfig.sol [Line: 97](contracts/core/GasXConfig.sol#L97)

	```solidity
	    function bulkSetMaxUsd(bytes4[] calldata selectors, uint256[] calldata maxUsds) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 178](contracts/core/GasXERC20FeePaymaster.sol#L178)

	```solidity
	    function setOracleSigner(address _newSigner) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 189](contracts/core/GasXERC20FeePaymaster.sol#L189)

	```solidity
	    function setMinFee(uint256 _newMinFee) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 199](contracts/core/GasXERC20FeePaymaster.sol#L199)

	```solidity
	    function setFeeMarkup(uint256 _newMarkupBps) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 211](contracts/core/GasXERC20FeePaymaster.sol#L211)

	```solidity
	    function withdrawFees(address _to, uint256 _amount) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 228](contracts/core/GasXERC20FeePaymaster.sol#L228)

	```solidity
	    function withdrawToken(address _token, address _to, uint256 _amount) external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 238](contracts/core/GasXERC20FeePaymaster.sol#L238)

	```solidity
	    function pause() external onlyOwner {
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 245](contracts/core/GasXERC20FeePaymaster.sol#L245)

	```solidity
	    function unpause() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 256](contracts/core/GasXSubscriptions.sol#L256)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 271](contracts/core/GasXSubscriptions.sol#L271)

	```solidity
	    function scheduleUpgrade(address newImplementation) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 283](contracts/core/GasXSubscriptions.sol#L283)

	```solidity
	    function cancelUpgrade() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 530](contracts/core/GasXSubscriptions.sol#L530)

	```solidity
	    ) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 544](contracts/core/GasXSubscriptions.sol#L544)

	```solidity
	    function refundCredits(address user, uint256 amount) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 611](contracts/core/GasXSubscriptions.sol#L611)

	```solidity
	    ) external onlyOwner returns (uint256 planId) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 635](contracts/core/GasXSubscriptions.sol#L635)

	```solidity
	    ) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 655](contracts/core/GasXSubscriptions.sol#L655)

	```solidity
	    ) external onlyOwner returns (uint256 packId) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 671](contracts/core/GasXSubscriptions.sol#L671)

	```solidity
	    function addSupportedToken(address token, uint8 decimals) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 681](contracts/core/GasXSubscriptions.sol#L681)

	```solidity
	    function removeSupportedToken(address token) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 689](contracts/core/GasXSubscriptions.sol#L689)

	```solidity
	    function setTreasury(address newTreasury) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 698](contracts/core/GasXSubscriptions.sol#L698)

	```solidity
	    function setFeeCollector(address newFeeCollector) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 708](contracts/core/GasXSubscriptions.sol#L708)

	```solidity
	    function transferOwnership(address newOwner) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 729](contracts/core/GasXSubscriptions.sol#L729)

	```solidity
	    function cancelOwnershipTransfer() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 742](contracts/core/GasXSubscriptions.sol#L742)

	```solidity
	    function pause() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 749](contracts/core/GasXSubscriptions.sol#L749)

	```solidity
	    function unpause() external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 763](contracts/core/GasXSubscriptions.sol#L763)

	```solidity
	    ) external onlyOwner {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 774](contracts/core/GasXSubscriptions.sol#L774)

	```solidity
	    function emergencyWithdrawEth(address to, uint256 amount) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 230](contracts/core/GasXWhitelistPaymaster.sol#L230)

	```solidity
	    function setLimit(uint256 gas, uint256 usd) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 241](contracts/core/GasXWhitelistPaymaster.sol#L241)

	```solidity
	    function setSelector(bytes4 sel, bool allowed) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 251](contracts/core/GasXWhitelistPaymaster.sol#L251)

	```solidity
	    function setDevMode(bool enabled) external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 260](contracts/core/GasXWhitelistPaymaster.sol#L260)

	```solidity
	    function pause() external onlyOwner {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 268](contracts/core/GasXWhitelistPaymaster.sol#L268)

	```solidity
	    function unpause() external onlyOwner {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 119](contracts/factories/AggregatorFactory.sol#L119)

	```solidity
	    function transferOwnership(address newOwner) external onlyOwner {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 145](contracts/factories/AggregatorFactory.sol#L145)

	```solidity
	    ) external onlyOwner returns (address aggregator) {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 186](contracts/factories/AggregatorFactory.sol#L186)

	```solidity
	    function removeAggregator(address base, address quote) external onlyOwner {
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 201](contracts/factories/AggregatorFactory.sol#L201)

	```solidity
	    function transferAggregatorOwnership(address base, address quote, address newOwner) external onlyOwner {
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 57](contracts/factories/DIAAdapterFactory.sol#L57)

	```solidity
	    function deployAdapter(address base, address quote, string calldata key) external onlyOwner returns (address) {
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 51](contracts/oracles/DIAOracleAdapter.sol#L51)

	```solidity
	    function setPairKey(address base, address quote, string memory key) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 96](contracts/oracles/MultiOracleAggregator.sol#L96)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal view override onlyOwner {}
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 116](contracts/oracles/MultiOracleAggregator.sol#L116)

	```solidity
	    function addOracle(address base, address quote, address oracle) external onlyOwner onlyValidPair(base, quote) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 131](contracts/oracles/MultiOracleAggregator.sol#L131)

	```solidity
	    function removeOracle(address base, address quote, uint256 index) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 147](contracts/oracles/MultiOracleAggregator.sol#L147)

	```solidity
	    function updateOracle(address base, address quote, uint256 index, address newOracle) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 165](contracts/oracles/MultiOracleAggregator.sol#L165)

	```solidity
	    function toggleOracle(address base, address quote, uint256 index, bool enabled) external onlyOwner {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 177](contracts/oracles/MultiOracleAggregator.sol#L177)

	```solidity
	    function setMaxDeviationBps(uint256 bps) external onlyOwner {
	```

</details>



## L-2: Unspecific Solidity Pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>23 Found Instances</summary>


- Found in contracts/SimpleAccount.sol [Line: 2](contracts/SimpleAccount.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/SimpleAccountFactory.sol [Line: 2](contracts/SimpleAccountFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXConfig.sol [Line: 2](contracts/core/GasXConfig.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 2](contracts/core/GasXERC20FeePaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 2](contracts/core/GasXSubscriptions.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 2](contracts/core/GasXWhitelistPaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 2](contracts/factories/AggregatorFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 2](contracts/factories/DIAAdapterFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/imports/Imports.sol [Line: 2](contracts/imports/Imports.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IDIAOracleV2.sol [Line: 2](contracts/interfaces/IDIAOracleV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IOracleAggregator.sol [Line: 2](contracts/interfaces/IOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IPriceOracle.sol [Line: 2](contracts/interfaces/IPriceOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20.sol [Line: 2](contracts/mocks/MockERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20Decimals.sol [Line: 2](contracts/mocks/MockERC20Decimals.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 2](contracts/mocks/MockEulerOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockOracle.sol [Line: 2](contracts/mocks/MockOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockTarget.sol [Line: 2](contracts/mocks/MockTarget.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 2](contracts/oracles/DIAOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/EulerOracleAdapter.sol [Line: 2](contracts/oracles/EulerOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 2](contracts/oracles/MultiOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 2](contracts/testutils/MultiOracleAggregatorV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasX.sol [Line: 2](contracts/testutils/TestableGasX.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 2](contracts/testutils/TestableGasXERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

</details>



## L-3: Address State Variable Set Without Checks

Check for `address(0)` when assigning values to address state variables.

<details><summary>1 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 74](contracts/core/GasXConfig.sol#L74)

	```solidity
	        oracleSigner = newSigner;
	```

</details>



## L-4: Public Function Not Used Internally

If a function is marked public but is not used internally, consider marking it as `external`.

<details><summary>5 Found Instances</summary>


- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 282](contracts/core/GasXWhitelistPaymaster.sol#L282)

	```solidity
	    function isProd() public view returns (bool) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 230](contracts/oracles/MultiOracleAggregator.sol#L230)

	```solidity
	    function computeQuoteAverage(uint256 amount, address base, address quote) public view returns (uint256) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 302](contracts/oracles/MultiOracleAggregator.sol#L302)

	```solidity
	    function computeQuoteMedian(uint256 amount, address base, address quote) public view returns (uint256) {
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 26](contracts/testutils/MultiOracleAggregatorV2.sol#L26)

	```solidity
	    function initializeV2() public reinitializer(2) {
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 36](contracts/testutils/MultiOracleAggregatorV2.sol#L36)

	```solidity
	    function version() public pure returns (string memory) {
	```

</details>



## L-5: Literal Instead of Constant

Define and use `constant` variables instead of using literals. If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>55 Found Instances</summary>


- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 75](contracts/core/GasXERC20FeePaymaster.sol#L75)

	```solidity
	        require(_feeMarkupBps <= 1000, "GasX: Markup too high"); // Max 10%
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 126](contracts/core/GasXERC20FeePaymaster.sol#L126)

	```solidity
	        onChainPrice = priceOracle.computeQuoteAverage(1e18, priceQuoteBaseToken, feeToken);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 129](contracts/core/GasXERC20FeePaymaster.sol#L129)

	```solidity
	        require((diff * 10_000) / onChainPrice <= PRICE_DEVIATION_BPS, "GasX: Price deviation too high");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 137](contracts/core/GasXERC20FeePaymaster.sol#L137)

	```solidity
	        fee = (gasCost * price * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 156](contracts/core/GasXERC20FeePaymaster.sol#L156)

	```solidity
	        uint256 actualFee = (actualGasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 200](contracts/core/GasXERC20FeePaymaster.sol#L200)

	```solidity
	        require(_newMarkupBps <= 1000, "GasX: Markup too high");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 273](contracts/core/GasXERC20FeePaymaster.sol#L273)

	```solidity
	        uint256 onChainPrice = priceOracle.computeQuoteAverage(1e18, priceQuoteBaseToken, feeToken);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 276](contracts/core/GasXERC20FeePaymaster.sol#L276)

	```solidity
	        estimatedFee = (_gasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 306](contracts/core/GasXERC20FeePaymaster.sol#L306)

	```solidity
	        require(data.length >= 32 + 6, "GasX: Invalid paymaster data length");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 308](contracts/core/GasXERC20FeePaymaster.sol#L308)

	```solidity
	        price = abi.decode(data[:32], (uint256));
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 309](contracts/core/GasXERC20FeePaymaster.sol#L309)

	```solidity
	        expiry = uint48(bytes6(data[32:38]));
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 310](contracts/core/GasXERC20FeePaymaster.sol#L310)

	```solidity
	        signature = data[38:];
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 244](contracts/core/GasXSubscriptions.sol#L244)

	```solidity
	        tokenDecimals[_usdc] = 6;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 245](contracts/core/GasXSubscriptions.sol#L245)

	```solidity
	        emit TokenAdded(_usdc, 6);
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 317](contracts/core/GasXSubscriptions.sol#L317)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 364](contracts/core/GasXSubscriptions.sol#L364)

	```solidity
	        uint256 fee = (plan.priceEth * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 440](contracts/core/GasXSubscriptions.sol#L440)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 799](contracts/core/GasXSubscriptions.sol#L799)

	```solidity
	        if (decimals == 6) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 801](contracts/core/GasXSubscriptions.sol#L801)

	```solidity
	        } else if (decimals > 6) {
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 802](contracts/core/GasXSubscriptions.sol#L802)

	```solidity
	            result = usdcAmount * (10 ** (decimals - 6));
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 804](contracts/core/GasXSubscriptions.sol#L804)

	```solidity
	            result = usdcAmount / (10 ** (6 - decimals));
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 820](contracts/core/GasXSubscriptions.sol#L820)

	```solidity
	            durationDays: 30,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 821](contracts/core/GasXSubscriptions.sol#L821)

	```solidity
	            platformFeeBps: 500, // 5%
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 830](contracts/core/GasXSubscriptions.sol#L830)

	```solidity
	            durationDays: 30,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 831](contracts/core/GasXSubscriptions.sol#L831)

	```solidity
	            platformFeeBps: 250, // 2.5%
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 840](contracts/core/GasXSubscriptions.sol#L840)

	```solidity
	            durationDays: 30,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 841](contracts/core/GasXSubscriptions.sol#L841)

	```solidity
	            platformFeeBps: 100, // 1%
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 850](contracts/core/GasXSubscriptions.sol#L850)

	```solidity
	            durationDays: 365,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 851](contracts/core/GasXSubscriptions.sol#L851)

	```solidity
	            platformFeeBps: 250,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 860](contracts/core/GasXSubscriptions.sol#L860)

	```solidity
	            durationDays: 365,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 861](contracts/core/GasXSubscriptions.sol#L861)

	```solidity
	            platformFeeBps: 100,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 873](contracts/core/GasXSubscriptions.sol#L873)

	```solidity
	            credits: 100,
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 883](contracts/core/GasXSubscriptions.sol#L883)

	```solidity
	            credits: 500,
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 163](contracts/core/GasXWhitelistPaymaster.sol#L163)

	```solidity
	        if (pData.length > 52) {
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 307](contracts/core/GasXWhitelistPaymaster.sol#L307)

	```solidity
	        bytes calldata data = pData[52:];
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 308](contracts/core/GasXWhitelistPaymaster.sol#L308)

	```solidity
	        require(data.length >= 6, "invalid paymaster data length for expiry");
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 309](contracts/core/GasXWhitelistPaymaster.sol#L309)

	```solidity
	        expiry = uint48(bytes6(data[:6]));
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 310](contracts/core/GasXWhitelistPaymaster.sol#L310)

	```solidity
	        sig = data[6:];
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 89](contracts/oracles/MultiOracleAggregator.sol#L89)

	```solidity
	        require(deviationBps <= 10_000, "too high");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 178](contracts/oracles/MultiOracleAggregator.sol#L178)

	```solidity
	        require(bps <= 10_000, "too high");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 216](contracts/oracles/MultiOracleAggregator.sol#L216)

	```solidity
	            if ((diff * 10_000) / avg > maxDeviationBps) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 252](contracts/oracles/MultiOracleAggregator.sol#L252)

	```solidity
	            if ((diff * 10_000) / avg > maxDeviationBps) revert("deviation too high");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 287](contracts/oracles/MultiOracleAggregator.sol#L287)

	```solidity
	            if ((diff * 10_000) / med > maxDeviationBps) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 323](contracts/oracles/MultiOracleAggregator.sol#L323)

	```solidity
	            if ((diff * 10_000) / med > maxDeviationBps) {
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 65](contracts/testutils/TestableGasXERC20.sol#L65)

	```solidity
	            bytes16(uint128(100000)),         // 16 bytes: verificationGasLimit
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 66](contracts/testutils/TestableGasXERC20.sol#L66)

	```solidity
	            bytes16(uint128(100000)),         // 16 bytes: postOpGasLimit
	```

</details>



## L-6: PUSH0 Opcode

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>23 Found Instances</summary>


- Found in contracts/SimpleAccount.sol [Line: 2](contracts/SimpleAccount.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/SimpleAccountFactory.sol [Line: 2](contracts/SimpleAccountFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXConfig.sol [Line: 2](contracts/core/GasXConfig.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 2](contracts/core/GasXERC20FeePaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 2](contracts/core/GasXSubscriptions.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 2](contracts/core/GasXWhitelistPaymaster.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 2](contracts/factories/AggregatorFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 2](contracts/factories/DIAAdapterFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/imports/Imports.sol [Line: 2](contracts/imports/Imports.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IDIAOracleV2.sol [Line: 2](contracts/interfaces/IDIAOracleV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IOracleAggregator.sol [Line: 2](contracts/interfaces/IOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/interfaces/IPriceOracle.sol [Line: 2](contracts/interfaces/IPriceOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20.sol [Line: 2](contracts/mocks/MockERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockERC20Decimals.sol [Line: 2](contracts/mocks/MockERC20Decimals.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockEulerOracle.sol [Line: 2](contracts/mocks/MockEulerOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockOracle.sol [Line: 2](contracts/mocks/MockOracle.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/mocks/MockTarget.sol [Line: 2](contracts/mocks/MockTarget.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 2](contracts/oracles/DIAOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/EulerOracleAdapter.sol [Line: 2](contracts/oracles/EulerOracleAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 2](contracts/oracles/MultiOracleAggregator.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/MultiOracleAggregatorV2.sol [Line: 2](contracts/testutils/MultiOracleAggregatorV2.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasX.sol [Line: 2](contracts/testutils/TestableGasX.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 2](contracts/testutils/TestableGasXERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.24;
	```

</details>



## L-7: Modifier Invoked Only Once

Consider removing the modifier or inlining the logic into the calling function.

<details><summary>3 Found Instances</summary>


- Found in contracts/factories/DIAAdapterFactory.sol [Line: 33](contracts/factories/DIAAdapterFactory.sol#L33)

	```solidity
	    modifier onlyOwner() {
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 29](contracts/oracles/DIAOracleAdapter.sol#L29)

	```solidity
	    modifier onlyOwner() {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 99](contracts/oracles/MultiOracleAggregator.sol#L99)

	```solidity
	    modifier onlyValidPair(address base, address quote) {
	```

</details>



## L-8: Empty Block

Consider removing empty blocks.

<details><summary>1 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 96](contracts/oracles/MultiOracleAggregator.sol#L96)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal view override onlyOwner {}
	```

</details>



## L-9: Large Numeric Literal

Large literal values multiples of 10000 can be replaced with scientific notation.Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>34 Found Instances</summary>


- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 129](contracts/core/GasXERC20FeePaymaster.sol#L129)

	```solidity
	        require((diff * 10_000) / onChainPrice <= PRICE_DEVIATION_BPS, "GasX: Price deviation too high");
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 137](contracts/core/GasXERC20FeePaymaster.sol#L137)

	```solidity
	        fee = (gasCost * price * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 156](contracts/core/GasXERC20FeePaymaster.sol#L156)

	```solidity
	        uint256 actualFee = (actualGasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXERC20FeePaymaster.sol [Line: 276](contracts/core/GasXERC20FeePaymaster.sol#L276)

	```solidity
	        estimatedFee = (_gasCost * onChainPrice * (10_000 + feeMarkupBps)) / (1e18 * 10_000);
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 317](contracts/core/GasXSubscriptions.sol#L317)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 364](contracts/core/GasXSubscriptions.sol#L364)

	```solidity
	        uint256 fee = (plan.priceEth * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 440](contracts/core/GasXSubscriptions.sol#L440)

	```solidity
	        uint256 fee = (price * plan.platformFeeBps) / 10000;
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 828](contracts/core/GasXSubscriptions.sol#L828)

	```solidity
	            priceUsdc: 99_000000, // 99 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 829](contracts/core/GasXSubscriptions.sol#L829)

	```solidity
	            priceEth: 40000000000000000, // 0.04 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 838](contracts/core/GasXSubscriptions.sol#L838)

	```solidity
	            priceUsdc: 499_000000, // 499 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 839](contracts/core/GasXSubscriptions.sol#L839)

	```solidity
	            priceEth: 200000000000000000, // 0.2 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 848](contracts/core/GasXSubscriptions.sol#L848)

	```solidity
	            priceUsdc: 999_000000, // 999 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 849](contracts/core/GasXSubscriptions.sol#L849)

	```solidity
	            priceEth: 400000000000000000, // 0.4 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 858](contracts/core/GasXSubscriptions.sol#L858)

	```solidity
	            priceUsdc: 4990_000000, // 4990 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 859](contracts/core/GasXSubscriptions.sol#L859)

	```solidity
	            priceEth: 2000000000000000000, // 2 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 875](contracts/core/GasXSubscriptions.sol#L875)

	```solidity
	            priceUsdc: 10_000000, // 10 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 876](contracts/core/GasXSubscriptions.sol#L876)

	```solidity
	            priceEth: 4000000000000000, // 0.004 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 885](contracts/core/GasXSubscriptions.sol#L885)

	```solidity
	            priceUsdc: 45_000000, // 45 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 886](contracts/core/GasXSubscriptions.sol#L886)

	```solidity
	            priceEth: 18000000000000000, // 0.018 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 895](contracts/core/GasXSubscriptions.sol#L895)

	```solidity
	            priceUsdc: 80_000000, // 80 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 896](contracts/core/GasXSubscriptions.sol#L896)

	```solidity
	            priceEth: 32000000000000000, // 0.032 ETH
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 905](contracts/core/GasXSubscriptions.sol#L905)

	```solidity
	            priceUsdc: 350_000000, // 350 USDC
	```

- Found in contracts/core/GasXSubscriptions.sol [Line: 906](contracts/core/GasXSubscriptions.sol#L906)

	```solidity
	            priceEth: 140000000000000000, // 0.14 ETH
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 89](contracts/oracles/MultiOracleAggregator.sol#L89)

	```solidity
	        require(deviationBps <= 10_000, "too high");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 178](contracts/oracles/MultiOracleAggregator.sol#L178)

	```solidity
	        require(bps <= 10_000, "too high");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 216](contracts/oracles/MultiOracleAggregator.sol#L216)

	```solidity
	            if ((diff * 10_000) / avg > maxDeviationBps) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 252](contracts/oracles/MultiOracleAggregator.sol#L252)

	```solidity
	            if ((diff * 10_000) / avg > maxDeviationBps) revert("deviation too high");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 287](contracts/oracles/MultiOracleAggregator.sol#L287)

	```solidity
	            if ((diff * 10_000) / med > maxDeviationBps) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 323](contracts/oracles/MultiOracleAggregator.sol#L323)

	```solidity
	            if ((diff * 10_000) / med > maxDeviationBps) {
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 65](contracts/testutils/TestableGasXERC20.sol#L65)

	```solidity
	            bytes16(uint128(100000)),         // 16 bytes: verificationGasLimit
	```

- Found in contracts/testutils/TestableGasXERC20.sol [Line: 66](contracts/testutils/TestableGasXERC20.sol#L66)

	```solidity
	            bytes16(uint128(100000)),         // 16 bytes: postOpGasLimit
	```

</details>



## L-10: Loop Contains `require`/`revert`

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>10 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 119](contracts/oracles/MultiOracleAggregator.sol#L119)

	```solidity
	        for (uint256 i; i < list.length; i++) require(list[i].oracleAddress != oracle, "duplicate");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 151](contracts/oracles/MultiOracleAggregator.sol#L151)

	```solidity
	        for (uint256 i; i < list.length; i++) require(list[i].oracleAddress != newOracle, "duplicate");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 200](contracts/oracles/MultiOracleAggregator.sol#L200)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 214](contracts/oracles/MultiOracleAggregator.sol#L214)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 237](contracts/oracles/MultiOracleAggregator.sol#L237)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 250](contracts/oracles/MultiOracleAggregator.sol#L250)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 271](contracts/oracles/MultiOracleAggregator.sol#L271)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 285](contracts/oracles/MultiOracleAggregator.sol#L285)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 308](contracts/oracles/MultiOracleAggregator.sol#L308)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 321](contracts/oracles/MultiOracleAggregator.sol#L321)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

</details>



## L-11: Uninitialized Local Variable

Initialize all the variables. If a variable is meant to be initialized to zero, explicitly set it to zero to improve code readability.

<details><summary>12 Found Instances</summary>


- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 119](contracts/oracles/MultiOracleAggregator.sol#L119)

	```solidity
	        for (uint256 i; i < list.length; i++) require(list[i].oracleAddress != oracle, "duplicate");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 151](contracts/oracles/MultiOracleAggregator.sol#L151)

	```solidity
	        for (uint256 i; i < list.length; i++) require(list[i].oracleAddress != newOracle, "duplicate");
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 200](contracts/oracles/MultiOracleAggregator.sol#L200)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 211](contracts/oracles/MultiOracleAggregator.sol#L211)

	```solidity
	        for (uint256 i; i < count; i++) sum += quotes[i];
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 214](contracts/oracles/MultiOracleAggregator.sol#L214)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 237](contracts/oracles/MultiOracleAggregator.sol#L237)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 247](contracts/oracles/MultiOracleAggregator.sol#L247)

	```solidity
	        for (uint256 i; i < count; i++) sum += quotes[i];
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 250](contracts/oracles/MultiOracleAggregator.sol#L250)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 271](contracts/oracles/MultiOracleAggregator.sol#L271)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 285](contracts/oracles/MultiOracleAggregator.sol#L285)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 308](contracts/oracles/MultiOracleAggregator.sol#L308)

	```solidity
	        for (uint256 i; i < list.length; i++) {
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 321](contracts/oracles/MultiOracleAggregator.sol#L321)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

</details>



## L-12: Costly operations inside loop

Invoking `SSTORE` operations in loops may waste gas. Use a local variable to hold the loop computation result.

<details><summary>1 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 99](contracts/core/GasXConfig.sol#L99)

	```solidity
	        for (uint256 i = 0; i < selectors.length; i++) {
	```

</details>



## L-13: Missing Inheritance

There is an interface / abstract contract that is potentially missing (not included in) the inheritance of this contract.

<details><summary>1 Found Instances</summary>


- Found in contracts/core/GasXConfig.sol [Line: 12](contracts/core/GasXConfig.sol#L12)

	Is this contract supposed to implement an interface? Consider extending one of the following: IGasXConfig
	```solidity
	contract GasXConfig {
	```

</details>



## L-14: Unused Import

Redundant import statement. Consider removing it.

<details><summary>7 Found Instances</summary>


- Found in contracts/SimpleAccount.sol [Line: 3](contracts/SimpleAccount.sol#L3)

	```solidity
	import "@account-abstraction/contracts/accounts/SimpleAccount.sol";
	```

- Found in contracts/SimpleAccountFactory.sol [Line: 3](contracts/SimpleAccountFactory.sol#L3)

	```solidity
	import "@account-abstraction/contracts/accounts/SimpleAccountFactory.sol";
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 6](contracts/factories/AggregatorFactory.sol#L6)

	```solidity
	import { IPriceOracle } from "../interfaces/IPriceOracle.sol";
	```

- Found in contracts/factories/AggregatorFactory.sol [Line: 7](contracts/factories/AggregatorFactory.sol#L7)

	```solidity
	import { EulerOracleAdapter } from "../oracles/EulerOracleAdapter.sol";
	```

- Found in contracts/factories/DIAAdapterFactory.sol [Line: 5](contracts/factories/DIAAdapterFactory.sol#L5)

	```solidity
	import { IOracleAggregator } from "../interfaces/IOracleAggregator.sol";
	```

- Found in contracts/imports/Imports.sol [Line: 9](contracts/imports/Imports.sol#L9)

	```solidity
	import "@account-abstraction/contracts/core/EntryPoint.sol";
	```

- Found in contracts/oracles/MultiOracleAggregator.sol [Line: 7](contracts/oracles/MultiOracleAggregator.sol#L7)

	```solidity
	import { ContextUpgradeable } from "@openzeppelin/contracts-upgradeable/utils/ContextUpgradeable.sol"; // Aseg√∫rate de importar esto
	```

</details>



## L-15: State Change Without Event

There are state variable changes in this function but no event is emitted. Consider emitting an event to enable offchain indexers to track the changes.

<details><summary>5 Found Instances</summary>


- Found in contracts/mocks/MockEulerOracle.sol [Line: 17](contracts/mocks/MockEulerOracle.sol#L17)

	```solidity
	    function setMockPrice(uint256 _price) external {
	```

- Found in contracts/mocks/MockOracle.sol [Line: 17](contracts/mocks/MockOracle.sol#L17)

	```solidity
	    function setQuote(uint256 newQuote) external {
	```

- Found in contracts/mocks/MockOracle.sol [Line: 21](contracts/mocks/MockOracle.sol#L21)

	```solidity
	    function setRevert(bool shouldRevert) external {
	```

- Found in contracts/mocks/MockTarget.sol [Line: 7](contracts/mocks/MockTarget.sol#L7)

	```solidity
	    function execute() external {
	```

- Found in contracts/oracles/DIAOracleAdapter.sol [Line: 51](contracts/oracles/DIAOracleAdapter.sol#L51)

	```solidity
	    function setPairKey(address base, address quote, string memory key) external onlyOwner {
	```

</details>



## L-16: State Variable Could Be Immutable

State variables that are only changed in the constructor should be declared immutable to save gas. Add the `immutable` attribute to state variables that are only changed in the constructor

<details><summary>1 Found Instances</summary>


- Found in contracts/core/GasXWhitelistPaymaster.sol [Line: 72](contracts/core/GasXWhitelistPaymaster.sol#L72)

	```solidity
	    Environment public environment;
	```

</details>



